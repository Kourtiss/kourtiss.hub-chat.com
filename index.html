<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kourtiss' Cult Chat</title>
    <style>
        /* Include your CSS styles here */
    </style>
</head>
<body>
    <header>
        <h1>Welcome to Kourtiss' Cult Chat!</h1>
    </header>

    <!-- Chat Section -->
    <div class="chat-section">
        <h2>Chat with Everyone!</h2>
        <div class="chat-box"></div>
        <form class="chat-form" onsubmit="sendMessage(event)">
            <input type="text" placeholder="Type your message..." required>
            <button type="submit">Send</button>
        </form>
    </div>

    <footer>
        <p>&copy; 2024 Kourtiss' Cult. <a href="#">Privacy Policy</a></p>
    </footer>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js"></script>

    <script>
        // Import the necessary Firebase functions for Firebase Modular SDK
        import { initializeApp } from 'firebase/app';
        import { getFirestore, collection, getDocs, addDoc, orderBy, query, serverTimestamp } from 'firebase/firestore';

        // Your Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyBYB7ckVgU8vayGD18EknMw79UccYQNWFY",
            authDomain: "kourtiss-chat.firebaseapp.com",
            projectId: "kourtiss-chat",
            storageBucket: "kourtiss-chat.firebasestorage.app",
            messagingSenderId: "610639722559",
            appId: "1:610639722559:web:05c90913807917a4fde08a",
            measurementId: "G-EHSS18YG2D"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Function to load messages from Firestore
        async function loadMessages() {
            const q = query(collection(db, "messages"), orderBy("timestamp"));
            const querySnapshot = await getDocs(q);
            const chatBox = document.querySelector('.chat-box');
            chatBox.innerHTML = '';  // Clear existing messages

            querySnapshot.forEach((doc) => {
                const message = doc.data();
                const messageElement = document.createElement('p');
                messageElement.innerHTML = `<strong>${message.name}:</strong> ${message.text}`;
                chatBox.appendChild(messageElement);
            });
        }

        // Function to send a new message
        async function sendMessage(event) {
            event.preventDefault();
            const messageInput = document.querySelector('.chat-form input[type="text"]');
            const messageText = messageInput.value.trim();
            if (messageText === '') return;

            const userName = "Kourtiss";  // You can customize this with a global user identifier

            await addDoc(collection(db, "messages"), {
                name: userName,
                text: messageText,
                timestamp: serverTimestamp()
            });

            messageInput.value = ''; // Clear the input field
            loadMessages(); // Reload messages
        }

        // Load initial messages when the page loads
        document.addEventListener('DOMContentLoaded', loadMessages);
    </script>
</body>
</html>
